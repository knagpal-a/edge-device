import{t as S}from"../__chunks__/toCamelCase.fmNGsVmq.js";import{t as V}from"../__chunks__/toClassName.DLENMWzL.js";function u(e,t){const r=document.createElement(e);return t&&(r.className=t),r}function m(e,t=null){const r=S(e);return t?`${r}-${S(t)}`:r}function C(e,t){const r=u("p","field-help-text");return r.textContent=e,r.id=`${t}-help`,r}function g(e,t="label",r=null,n=!1){const l=u(t);return l.textContent=e,r&&t==="label"&&l.setAttribute("for",r),n&&(l.dataset.required="true"),l}function N(e){const{type:t,field:r,required:n,default:l,placeholder:i}=e,o=u("input");return o.type=t||"text",o.id=m(r||"field"),o.name=o.id,o.required=n==="true",l&&(o.value=l),i&&(o.placeholder=i),o}function O(e){const{field:t,required:r,default:n,placeholder:l}=e,i=u("textarea");return i.id=m(t||"field"),i.name=i.id,i.required=r==="true",i.rows=5,n&&(i.value=n),l&&(i.placeholder=l),i}function _(e,t){const{type:r,field:n,default:l,required:i}=e,o=m(n||"field",t),s=u("input");return s.type=r||"text",s.id=o,s.name=m(n||"field"),s.value=t,s.checked=t===l,s.required=i==="true",s}function $(e,t){const{type:r,options:n,label:l,required:i}=e;if(!n)return null;const o=u("fieldset",`form-field ${r}-field`);if(t){const s=t.split("-")[0];o.dataset.controller=s,o.dataset.condition=t}return o.append(g(l||"","legend",null,i==="true")),n.split(",").forEach(s=>{const a=s.trim(),c=_(e,a),d=u("span"),f=g(a,"label",c.id);f.prepend(c,d),o.append(f)}),o}async function I(e){const t=await fetch(e),{data:r}=await t.json();return r.map(l=>{const{option:i,value:o}=l,s=u("option");return i&&o?(s.value=o,s.textContent=i):i&&!o?(s.value=i,s.textContent=i):o&&!i&&(s.value=o,s.textContent=o),s})}function M(e,t){const{type:r,options:n,field:l,label:i,required:o,placeholder:s}=e;if(!n)return null;const a=u("div",`form-field ${r||"text"}-field`);if(t){const d=t.split("-")[0];a.dataset.controller=d,a.dataset.condition=t}a.append(g(i||"","label",m(l||"field"),o==="true"));const c=u("select");if(c.id=m(l||"field"),c.name=c.id,c.required=o==="true",a.append(c),s){const d=u("option");d.value="",d.textContent=s,d.disabled=!0,d.selected=!0,c.append(d)}try{const d=new URL(n);I(d).then(f=>{c.append(...f)})}catch{n.split(",").forEach(f=>{const p=f.trim(),b=u("option");b.value=p,b.textContent=p,c.append(b)})}return a}function P(e,t){const{label:r,required:n,default:l}=e,i=u("div","form-field toggle-field");if(t){const c=t.split("-")[0];i.dataset.controller=c,i.dataset.condition=t}const o=_({...e,type:"checkbox"},l||"true");o.setAttribute("role","switch"),o.setAttribute("aria-checked",String(o.checked)),o.addEventListener("change",()=>{o.setAttribute("aria-checked",String(o.checked))});const s=u("span"),a=g(r||"","label",o.id,n==="true");return a.prepend(o,s),i.append(a),i}function B(e){const{type:t,label:r}=e,n=u("button");return n.className="button",n.type=t||"button",n.textContent=r||"",t==="reset"&&n.classList.add("secondary"),n}function j(e,t){const{target:r}=e,n=r.name;t.has(n)&&[...t.get(n)||[]].forEach(i=>{const o=i.closest(".form-field"),{condition:s}=o.dataset,a=s?s.includes(V(r.value)):!1;o.setAttribute("aria-hidden",String(!a)),a?(i.dataset.originalRequired==="true"&&i.setAttribute("required",""),i.removeAttribute("tabindex")):(i.removeAttribute("required"),i.setAttribute("tabindex","-1"))})}function U(e,t){t.forEach((r,n)=>{let l=null;const i=e.querySelector(`[name="${n}"]:checked`),o=e.querySelector(`select[name="${n}"]`);if(i?l=i.value:o&&(l=o.value),l){const s=l;r.forEach(a=>{const c=a.closest(".form-field"),{condition:d}=c.dataset,f=d?d.includes(V(s)):!1;c.setAttribute("aria-hidden",String(!f)),a.hasAttribute("required")&&(a.dataset.originalRequired||(a.dataset.originalRequired="true"),f||a.removeAttribute("required")),f?a.removeAttribute("tabindex"):a.setAttribute("tabindex","-1")})}else r.forEach(s=>{s.closest(".form-field").setAttribute("aria-hidden","true"),s.hasAttribute("required")&&(s.dataset.originalRequired||(s.dataset.originalRequired="true"),s.removeAttribute("required")),s.setAttribute("tabindex","-1")})})}function W(e){const t=[...e.querySelectorAll("[data-controller]")],r=new Map;t.forEach(n=>{const l=n.querySelector("input, textarea, select"),{controller:i}=n.dataset;l&&i&&(r.has(i)||r.set(i,[]),(r.get(i)||[]).push(l),l&&l.id&&e.querySelectorAll(`[name="${i}"]`).forEach(s=>{const c=(s.getAttribute("aria-controls")||"").split(" ").filter(d=>d);c.includes(l.id)||c.push(l.id),s.setAttribute("aria-controls",c.join(" ")),l.setAttribute("aria-controlledby",s.id)}))}),U(e,r),e.addEventListener("change",n=>{j(n,r)})}function R(e){const{type:t,label:r,help:n,field:l,conditional:i}=e,o=i||null,s=l||"field";if(t==="hidden")return N(e);if(t==="submit"||t==="reset")return B(e);if(t==="radio"||t==="checkbox"){const p=$(e,o);if(p&&n){const b=C(n,m(s));p.append(b)}return p||u("div")}if(t==="toggle"){const p=P(e,o);if(n){const b=C(n,m(s));p.append(b)}return p}if(t==="select"){const p=M(e,o);if(p&&n){const b=C(n,m(s));p.append(b)}return p||u("div")}const a=u("div",`form-field ${t}-field`);if(o){const p=o.split("-")[0];a.dataset.controller=p,a.dataset.condition=o}const c=m(s);a.append(g(r||"","label",c,e.required==="true"));let d;n&&(d=C(n,c),a.append(d));const f=t==="textarea"?O(e):N(e);return t==="textarea"?a.append(f):a.firstChild?a.insertBefore(f,a.firstChild.nextSibling):a.append(f),d&&f.setAttribute("aria-describedby",d.id),a}function D(e,t){const r=u("form");r.setAttribute("novalidate","");const n=[];if(e.forEach(l=>{l.type==="submit"||l.type==="reset"?n.push(l):l.type!=="confirmation"&&r.append(R(l))}),n.length){const l=u("div","button-wrapper");n.forEach(i=>l.append(R(i))),r.append(l)}return W(r),r}function H(e,t,r=""){const n=e.find(l=>l.field===t);return n?n.default?n.default:n.value?n.value:r:r}function z(e,t){const r="otp",i=H(t,"resendLimitMessage","Resend OTP limit exhausted."),o="Resend OTP",s="Resend available in",a="/thank-you",c="Invalid OTP. Please try again.",d=e.querySelector(`input[name="${S(r)}"]`);if(!d)return;const f=d.closest(".form-field");if(!f)return;const p=u("div","otp-resend"),b=u("div","otp-resend__loader"),T=u("span","otp-resend__loader-text"),L=u("span","otp-resend__timer");b.append(T,L);const v=u("button","otp-resend__button");v.type="button",v.textContent=o;const E=u("div","otp-resend__message");E.textContent=i,p.append(b,v,E),f.append(p);const x=u("div","otp-verify__message");x.textContent=c,x.style.display="none",f.append(x);let k=0,q;const w=h=>{b.style.display=h==="loading"?"flex":"none",v.style.display=h==="ready"?"inline-flex":"none",E.style.display=h==="limit"?"block":"none"},F=h=>{let A=Number.isFinite(h)?h:0;T.textContent=s,w("loading");const y=()=>{L.textContent=` ${A}s`,A<=0&&(q!==void 0&&window.clearInterval(q),q=void 0,w("ready")),A-=1};y(),q=window.setInterval(y,1e3)};F(30),v.addEventListener("click",()=>{if(k+=1,k>3){w("limit");return}e.dispatchEvent(new CustomEvent("otp:resend",{bubbles:!0})),F(30)}),e.addEventListener("submit",()=>{d&&d.checkValidity()}),e.addEventListener("submit",h=>{if(h.preventDefault(),x.style.display="none",!e.reportValidity()){const y=e.querySelector(":invalid:not(fieldset)");y&&(y.focus(),y.scrollIntoView({behavior:"smooth",block:"center"}),y.setAttribute("aria-invalid","true"));return}d.value==="12345"?window.location.href=a:(x.style.display="block",d.focus())})}function K(e){e.style.visibility="hidden";const t=[];e.querySelectorAll("tr").forEach(l=>{var o,s;const i=l.querySelectorAll("td, th");if(i.length>=2){const a=((o=i[0].textContent)==null?void 0:o.trim())||"",c=((s=i[1].textContent)==null?void 0:s.trim())||"";a&&t.push({field:a,type:"hidden",default:c})}});const n=D([{field:"firstName",type:"text",label:"First name",placeholder:"Enter first name",required:"true"},{field:"lastName",type:"text",label:"Last name",placeholder:"Enter last name",required:"true"},{field:"mobile",type:"tel",label:"Mobile number",placeholder:"Enter mobile number",required:"true"},{field:"otp",type:"text",label:"OTP",placeholder:"Enter OTP",required:"true"},{field:"submit",type:"submit",label:"Verify OTP"}]);z(n,t),e.replaceChildren(n),e.removeAttribute("style")}export{K as default};
//# sourceMappingURL=form.js.map
